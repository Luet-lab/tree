steps:
- rm -rfv /opt/sabayon-build /etc/portage-gentoo || true
- bash portage_config.sh
- layman -S
- echo "yes" | layman -a sabayon || true
- echo "yes" | layman -a sabayon-distro || true
- cd /var/lib/layman/sabayon && git reset --hard {{.ForGentooCommit}}
- cd /var/lib/layman/sabayon-distro && git reset --hard {{.DistroCommit}}
# Create mask file of upstream packages
- source /sbin/sark-functions.sh && sabayon_mask_upstream_pkgs
- eselect profile set sabayon-distro:default/linux/amd64/17.0/sabayon
requires:
- category: "layer"
  name: "build"
  version: ">={{.LayerVersion}}"
- category: "layer"
  name: "sabayon-build-portage"
  version: ">={{.PortageVersion}}"
